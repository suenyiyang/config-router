<div align=center>
<h1>ğŸ‰ Config Router ğŸ‰</h1>

![English](https://img.shields.io/static/v1?label=current&message=ç®€ä½“ä¸­æ–‡&color=brightgreen) [![English](https://img.shields.io/static/v1?label=docs&message=English&color=lightgrey&logo=markdown)](./README.MD)

![Language](https://img.shields.io/github/languages/top/syy11cn/config-router?logo=typescript) ![License](https://img.shields.io/npm/l/@syy11cn/config-router) ![Version](https://img.shields.io/github/package-json/v/syy11cn/config-router?logo=npm) ![Contributors](https://img.shields.io/github/contributors/syy11cn/config-router?color=green) ![](https://img.shields.io/github/last-commit/syy11cn/config-router?color=blue&logo=github)

<p style="color: gray;">ä¸€ä¸ªåŸºäº React Router v5.x çš„è·¯ç”±é…ç½®ã€æ¸²æŸ“å’Œè·¯ç”±å®ˆå«åº“ã€‚</p>

</div>

<div align=center>

## `Config Router` æ˜¯ä»€ä¹ˆ? :thinking:

</div>

**Config Router** :wave: æ˜¯ä¸€ä¸ªé…åˆ _React Router v5.x_ ä½¿ç”¨çš„è·¯ç”±ç®¡ç†å·¥å…·ã€‚ åœ¨ _React Router_ çš„åŸºç¡€ä¸Šï¼Œæä¾› **è·¯ç”±é›†ä¸­é…ç½®ã€è·¯ç”±æ¸²æŸ“ä»¥åŠè·¯ç”±å®ˆå«** åŠŸèƒ½ã€‚

å¦‚æœä½ æ›¾ä½¿ç”¨è¿‡ _Vue Router_ï¼Œä½ å°†å¾ˆå®¹æ˜“å°±èƒ½ä¸Šæ‰‹ä½¿ç”¨ _Config Router_ã€‚å½“ç„¶ï¼Œæœ¬é¡¹ç›®ä¸å¦‚ _Vue Router_ é‚£æ ·æˆç†Ÿã€‚:joy:

<div align=center>

## åŠŸèƒ½ :tada:

</div>

- :heavy_check_mark: é€šè¿‡å£°æ˜ç±»ä¼¼ Vue Router ä¸­ `routes` æ•°ç»„çš„æ–¹å¼ **é…ç½®è·¯ç”±**ã€‚
- :heavy_check_mark: é€šè¿‡ `import` ä¸€ä¸ª `RouterView` ç»„ä»¶çš„æ–¹å¼ **æ¸²æŸ“è·¯ç”±** :eyes:ã€‚
- :heavy_check_mark: æ¸²æŸ“é¡µé¢å‰ï¼Œæ”¯æŒè‡ªå®šä¹‰ **è·¯ç”±å®ˆå«**ã€‚
- :o: æ•¬è¯·æœŸå¾…â€¦â€¦

<div align=center>

## ä½¿ç”¨æ–¹æ³• :book:

</div>

ä½ å¯ä»¥å°†è¿™ä¸ªåŒ…ç”¨äº `react-jsx` æˆ– `react-tsx` é¡¹ç›®ä¸­ã€‚åœ¨ä¸‹é¢çš„ä½¿ç”¨æ–¹æ³•ä¸­ï¼Œå°†ä»¥ `vite` + `react` + `typescript` æ­å»ºçš„é¡¹ç›®ä¸ºä¾‹ã€‚

### æ·»åŠ  `React Router` ä¾èµ–

```bash
yarn add -s react-router-dom
yarn add -D @types/react-router-dom
```

> æˆ–ä½¿ç”¨ `npm`.
>
> ```bash
> npm i -s react-router-dom
> npm i -D @types/react-router-dom
> ```

### æ·»åŠ  `Config Router` ä¾èµ–

æ·»åŠ å®Œ React Router ä¾èµ–åï¼Œä½ å¯ä»¥å°† `config-router` æ·»åŠ åˆ°é¡¹ç›®ä¸­ã€‚

```bash
yarn add -s @syy11cn/config-router
```

> æˆ–ä½¿ç”¨ `npm`.
>
> ```bash
> npm i -s @syy11cn/config-router
> ```

### æ·»åŠ é…ç½®æ–‡ä»¶

åœ¨ `src/routes` æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ˆä»¥ `config.ts` æ–‡ä»¶ä¸ºä¾‹ï¼‰ã€‚

ä»¥ä¸‹æ˜¯é…ç½®æ ·ä¾‹ã€‚

```ts
// é¦–å…ˆå¼•å…¥ `routeType` ç±»å‹å®šä¹‰
import { routeType } from '@syy11cn/config-router';
// å¼•å…¥éœ€è¦ç”¨åˆ°çš„ç»„ä»¶
import Index from '../views/Index';
import Portal from '../views/Portal';
import Test from '../views/Test';
import Error from '../views/Error';

// è·¯ç”±é…ç½®
const routes: Array<routeType> = [
  {
    path: '/home',
    component: Index,
    routes: [
      {
        path: '/home/test',
        component: Portal,
      },
      {
        path: '/home',
        component: Test,
      },
    ],
  },
  {
    path: '/404',
    component: Error,
  },
  {
    path: '/',
    component: Portal,
  },
];

export default routes;
```

å¦‚ä¸Šæ‰€ç¤ºï¼Œè·¯ç”±é…ç½®æ˜¯ä¸€ä¸ªç”± `routeType` å…ƒç´ ç»„æˆçš„æ•°ç»„ã€‚

`routeType` çš„å®šä¹‰å¦‚ä¸‹ï¼š

```ts
import * as React from 'react';

interface routeType {
  path: string;
  component: React.ComponentType<any>;
  exact?: boolean;
  routes?: Array<routeType> | undefined;
}

export default routeType;
```

å…¶ä¸­ `routes` å­—æ®µçš„å€¼æ˜¯ä¸€ä¸ªæ–°çš„ `routeType` æ•°ç»„ã€‚

**é…ç½®æ–‡ä»¶ç¼–å†™æç¤º**

- åœ¨ `routeType` æ•°ç»„ä¸­ï¼Œæ ¹è·¯ç”±åº”å½“æ°¸è¿œå¤„äºæ•°ç»„çš„æœ€åä¸€ä½ã€‚
- `exact: true` ä¸ `routes` å­—æ®µä¸å¯å…¼å¾—ã€‚
- `path` å’Œ `component` æ˜¯å¿…å¡«é¡¹ï¼›`exact` å’Œ `routes` æ˜¯å¯é€‰é¡¹ã€‚

### ä½¿ç”¨ `RouterView` ç»„ä»¶

åœ¨ `main.tsx` ä¸­, ç»™ `<App>` ç»„ä»¶çš„å¤–å±‚æ·»åŠ  `<Router>` ç»„ä»¶ã€‚

```tsx
import React from 'react';
import ReactDOM from 'react-dom';
import './index.css';
import App from './App';
import { BrowserRouter as Router } from 'react-router-dom';

ReactDOM.render(
  <React.StrictMode>
    <Router>
      <App></App>
    </Router>
  </React.StrictMode>,
  document.getElementById('root')
);
```

æ¥ä¸‹æ¥åœ¨ `App.tsx` ä¸­, ä½¿ç”¨ `RouterView` ç»„ä»¶ã€‚

```tsx
import { FunctionComponent } from 'react';
import { Layout } from 'antd';
import { RouterView } from '@syy11cn/config-router';
import routes from './routes/config';
import './App.css';

const { Header, Content, Footer } = Layout;

interface AppProps {}

const App: FunctionComponent<AppProps> = () => {
  return (
    <div align=center className="App">
      <Header></Header>
      <Content>
        <RouterView
          routes={routes}
          onEnter={function (to, next): void {
            console.log('onEnter');
            next();
          }}
        ></RouterView>
      </Content>
      <Footer></Footer>
    </div>
  );
};

export default App;
```

`RouterView` ç»„ä»¶å°†åœ¨ `<Content>` ç»„ä»¶ä¸­æ¸²æŸ“è·¯ç”±ã€‚æ¸²æŸ“çš„è·¯ç”±ç»„ä»¶å°†å–ä»£ `RouterView` çš„ä½ç½®ã€‚

### åµŒå¥—è·¯ç”±

åœ¨é…ç½®çš„ä¾‹å­ä¸­ï¼Œ`Index` ç»„ä»¶åŒ…å«åµŒå¥—è·¯ç”±ã€‚**æ³¨æ„ï¼šæ— è®ºä½ åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ `RouterView` ç»„ä»¶ï¼Œä½ éƒ½éœ€è¦ç»™å®ƒä¼ å…¥ `routes` å­—æ®µã€‚**

å› æ­¤ï¼Œåœ¨ `src/views/Index.tsx` ä¸­ï¼Œ`Index` ç»„ä»¶åº”è¯¥æ¥æ”¶ä¸€ä¸ª `routes` å±æ€§ã€‚è¿™ä¸ªå±æ€§åŒ…å«äº† `Index` ç»„ä»¶ä¸‹çš„å­è·¯ç”±ã€‚

```tsx
import { FunctionComponent } from 'react';
import { RouterView } from '../routes';
import { routeType } from '@syy11cn/config-router';

interface IndexProps {
  routes: Array<routeType>;
  props: any;
}

const Index: FunctionComponent<IndexProps> = ({ routes, props }) => {
  console.log('Index View');
  return (
    <div align=center>
      <h1>This is Index</h1>
      <RouterView
        routes={routes}
        onEnter={(to, next) => {
          if (to === '/home/test') {
            next();
          } else {
            next('/404');
          }
        }}
      ></RouterView>
    </div>
  );
};

export default Index;
```

### è·¯ç”±å®ˆå«

å‘ `onEnter` å­—æ®µä¸­ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°†åœ¨è·¯ç”±æ¸²æŸ“ä¹‹å‰è¢«æ‰§è¡Œã€‚

ä¼ å…¥çš„å‡½æ•°åº”è¯¥æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ `to` å’Œ `next`ã€‚

- `to` æ˜¯ä¸€ä¸ª `string` ç±»å‹çš„æ•°æ®ï¼Œç”¨äºè¡¨æ˜ç”¨æˆ·å°†è¦å‰å¾€å“ªä¸ªè·¯ç”±ã€‚
- `next` æ˜¯ä¸€ä¸ª `Function` ç±»å‹çš„æ•°æ®ï¼Œå¦‚æœä½ å‘ `next` å‡½æ•°ä¸­ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå®ƒå°†å¸®ä½ é‡å®šå‘åˆ°å¯¹åº”çš„è·¯å¾„ï¼›å¦‚æœä½ ç›´æ¥è°ƒç”¨ `next` å‡½æ•°ï¼Œåˆ™ä¼šæ”¾é€šç”¨æˆ·å½“å‰çš„è·¯ç”±ã€‚

ç¤ºä¾‹ä»£ç åŒä¸Šï¼š

```ts
import { FunctionComponent } from 'react';
import { RouterView } from '../routes';
import { routeType } from '@syy11cn/config-router';

interface IndexProps {
  routes: Array<routeType>;
  props: any;
}

const Index: FunctionComponent<IndexProps> = ({ routes, props }) => {
  console.log('Index View');
  return (
    <div align=center>
      <h1>This is Index</h1>
      <RouterView
        routes={routes}
        onEnter={(to, next) => {
          if (to === '/home/test') {
            next();
          } else {
            next('/404');
          }
        }}
      ></RouterView>
    </div>
  );
};

export default Index;
```

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“ç”¨æˆ·æƒ³è¦è®¿é—® `/home/test` æ—¶ï¼Œå¯¹åº”çš„è·¯ç”±å’Œç»„ä»¶å°†è¢«æ¸²æŸ“ã€‚è€Œå½“ç”¨æˆ·æƒ³è¦è®¿é—® `/home` æˆ–å…¶ä»–ä»¥ `/home` å¼€å¤´çš„åŸŸåæ—¶ï¼Œå…¶å°†è¢«é‡å®šå‘åˆ° `404` é¡µé¢ã€‚

<div align=center>

## è´¡çŒ® :computer:

</div>

æ¬¢è¿è´¡çŒ®ï¼ä½ å¯ä»¥ fork è¿™ä¸ªä»“åº“ï¼Œç„¶åæ PRã€‚

åœ¨ä½¿ç”¨ä¸­æœ‰ä»»ä½•é—®é¢˜ï¼Œä¹Ÿå¯ä»¥ [ç‚¹å‡»è¿™é‡Œå‘å¸ƒä¸€ä¸ª issue](https://github.com/syy11cn/config-router/issues)ï¼Œæˆ‘æ”¶åˆ°æ¶ˆæ¯åä¼šå°½å¿«å°½åŠ›å¤„ç†ã€‚

<div align=center>

## å…³äº :raised_hands:

</div>

### å¼€æºåè®®

[MIT](https://opensource.org/licenses/MIT)

Copyright (c) 2021, Yiyang Sun
